"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function isThenable(t){return t&&_lodashLangIsFunction2["default"](t.then)}function extractFunctions(){for(var t=[],e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];return _lodashLangIsFunction2["default"](n[0])?_lodashCollectionForEach2["default"](n,function(e){_lodashLangIsFunction2["default"](e)&&t.push(e)}):_lodashLangIsObject2["default"](n[0])&&_lodashCollectionForEach2["default"](n,function(e){_lodashCollectionForEach2["default"](e,function(e){_lodashLangIsFunction2["default"](e)&&t.push(e)})}),t}function addMethods(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return _supermixer.mixinFunctions.apply(void 0,[t.methods].concat(n))}function addRefs(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return t.refs=t.state=_supermixer.mixin.apply(void 0,[t.refs].concat(n)),t.refs}function addInit(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];var a=extractFunctions.apply(void 0,n);return t.init=t.enclose=t.init.concat(a),t.init}function addProps(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return _supermixer.merge.apply(void 0,[t.props].concat(n))}function addStatic(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return _supermixer.mixin.apply(void 0,[t["static"]].concat(n))}function cloneAndExtend(t,e){for(var n=stampit(t),r=arguments.length,a=Array(r>2?r-2:0),i=2;r>i;i++)a[i-2]=arguments[i];return e.apply(void 0,[n.fixed].concat(a)),n}function _compose(){for(var t=stampit(),e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];return _lodashCollectionForEach2["default"](n,function(e){e&&e.fixed&&(addMethods(t.fixed,e.fixed.methods),addRefs(t.fixed,e.fixed.refs||e.fixed.state),addInit(t.fixed,e.fixed.init||e.fixed.enclose),addProps(t.fixed,e.fixed.props),addStatic(t.fixed,e.fixed["static"]))}),_supermixer.mixin(t,t.fixed["static"])}function isStamp(t){return _lodashLangIsFunction2["default"](t)&&_lodashLangIsFunction2["default"](t.methods)&&(_lodashLangIsFunction2["default"](t.refs)||_lodashLangIsFunction2["default"](t.state))&&(_lodashLangIsFunction2["default"](t.init)||_lodashLangIsFunction2["default"](t.enclose))&&_lodashLangIsFunction2["default"](t.props)&&_lodashLangIsFunction2["default"](t["static"])&&_lodashLangIsObject2["default"](t.fixed)}function convertConstructor(t){var e=stampit();return e.fixed.refs=e.fixed.state=_supermixer.mergeChainNonFunctions(e.fixed.refs,t.prototype),_supermixer.mixin(e,_supermixer.mixin(e.fixed["static"],t)),_supermixer.mixinChainFunctions(e.fixed.methods,t.prototype),addInit(e.fixed,function(e){var n=e.instance,r=e.args;return t.apply(n,r)}),e}function shortcutMethod(t){for(var e=stampit(),n=arguments.length,r=Array(n>1?n-1:0),a=1;n>a;a++)r[a-1]=arguments[a];return t.apply(void 0,[e.fixed].concat(r)),e}Object.defineProperty(exports,"__esModule",{value:!0});var _lodashCollectionForEach=require("lodash/collection/forEach"),_lodashCollectionForEach2=_interopRequireDefault(_lodashCollectionForEach),_lodashLangIsFunction=require("lodash/lang/isFunction"),_lodashLangIsFunction2=_interopRequireDefault(_lodashLangIsFunction),_lodashLangIsObject=require("lodash/lang/isObject"),_lodashLangIsObject2=_interopRequireDefault(_lodashLangIsObject),_supermixer=require("supermixer"),create=Object.create,stampit=function(t){var e={methods:{},refs:{},init:[],props:{},"static":{}};e.state=e.refs,e.enclose=e.init,t&&(addMethods(e,t.methods),addRefs(e,t.refs),addInit(e,t.init),addProps(e,t.props),addStatic(e,t["static"]));var n=function(t){for(var r=arguments.length,a=Array(r>1?r-1:0),i=1;r>i;i++)a[i-1]=arguments[i];var o=_supermixer.mixin(create(e.methods),e.refs,t);_supermixer.mergeUnique(o,e.props);var s=null;return e.init.length>0&&_lodashCollectionForEach2["default"](e.init,function(t){if(_lodashLangIsFunction2["default"](t))if(s)s=s.then(function(e){o=e||o;var r=t.call(o,{args:a,instance:o,stamp:n});return r?isThenable(r)?r:o=r:o});else{var e=t.call(o,{args:a,instance:o,stamp:n});if(!e)return;if(!isThenable(e))return void(o=e);s=e}}),s?s.then(function(t){return t||o}):o},r=cloneAndExtend.bind(null,e,addRefs),a=cloneAndExtend.bind(null,e,addInit);return _supermixer.mixin(n,{create:n,fixed:e,methods:cloneAndExtend.bind(null,e,addMethods),refs:r,state:r,init:a,enclose:a,props:cloneAndExtend.bind(null,e,addProps),"static":function(){for(var t=arguments.length,e=Array(t),r=0;t>r;r++)e[r]=arguments[r];var a=cloneAndExtend.apply(void 0,[n.fixed,addStatic].concat(e));return _supermixer.mixin(a,a.fixed["static"])},compose:function(){for(var t=arguments.length,e=Array(t),r=0;t>r;r++)e[r]=arguments[r];return _compose.apply(void 0,[n].concat(e))}},e["static"])};exports["default"]=_supermixer.mixin(stampit,{methods:shortcutMethod.bind(null,addMethods),refs:shortcutMethod.bind(null,addRefs),init:shortcutMethod.bind(null,addInit),props:shortcutMethod.bind(null,addProps),"static":function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=shortcutMethod.apply(void 0,[addStatic].concat(e));return _supermixer.mixin(r,r.fixed["static"])},compose:_compose,mixin:_supermixer.mixin,extend:_supermixer.mixin,mixIn:_supermixer.mixin,assign:_supermixer.mixin,isStamp:isStamp,convertConstructor:convertConstructor}),module.exports=exports["default"];